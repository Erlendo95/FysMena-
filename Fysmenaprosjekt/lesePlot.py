# -*- coding: utf-8 -*-
"""
Created on Wed Oct 31 07:01:01 2018

@author: Erlendo
"""

import numpy as np
import matplotlib.pyplot as plt


energy_clean = [-17.963642, -18.411583, -18.524583, -18.488537, -18.459965, -18.447848, -18.441924, -18.444580, -18.447818, -18.452826, -18.457044, -18.459401, -18.461777, -18.461996, -18.462442, -18.462522, -18.463902]
force_clean = np.zeros(len(energy_clean))
pressure_clean = [-156.340000, -84.520000, -38.190000, -14.380000, -4.810000, -0.900000, 0.370000, -0.210000, -0.950000, -1.370000, -1.200000, -2.320000, -1.060000, -0.900000, -0.530000, -0.630000, -0.530000]
bandgap_clean = [1.5233, 1.5146, 1.5056, 1.506, 1.5025, 1.5023, 1.5019, 1.5019, 1.5018, 1.5019, 1.5018, 1.5019, 1.502, 1.5019, 1.5019, 1.5018, 1.5019]
encut = np.linspace(200, 1000, len(energy_clean))

energy_o1 = [-19.892305, -20.610969, -20.639394, -20.506154, -20.453646, -20.433267, -20.425876, -20.430765, -20.435569, -20.441164, -20.445609, -20.448444, -20.451243, -20.451787, -20.452071, -20.452493, -20.454064]
force_o1 = [2.233, 2.283, 2.312, 2.328, 2.323, 2.313, 2.307, 2.313, 2.309, 2.305, 2.314, 2.310, 2.303, 2.304, 2.316, 2.312, 2.309]
pressure_o1 = [-470.790000, -202.620000, -44.970000, 35.300000, 69.250000, 83.200000, 86.870000, 87.140000, 86.110000, 85.390000, 85.730000, 83.940000, 86.230000, 86.590000, 87.140000, 87.17000, 87.120000]
bandgap_o1 = [-2.0208, -2.1743, -2.0588, -2.0767, -2.0744, -2.072, -2.0717, -2.0716, -2.0717, -2.0712, -2.0711, -2.0714, -2.0714, -2.0713, -2.0714, -2.0714, -2.0714]

energy_almostclose = [-19.347256, -20.118869, -20.230063, -20.127387, -20.077640, -20.056343, -20.048574, -20.053749, -20.060106, -20.067590, -20.073519, -20.076991, -20.079946, -20.080498, -20.081007, -20.081376, -20.082864]
force_almostclose = [6.139, 6.347, 6.203, 5.887, 5.808, 5.789, 5.778, 5.777, 5.773, 5.755, 5.774, 5.737, 5.758, 5.765, 5.710, 5.737, 5.752]
pressure_almostclose = [-415.790000, -148.230000, 15.240000, 98.590000, 132.820000, 146.200000, 149.810000, 149.770000, 148.570000, 147.720000, 148.190000, 146.330000, 148.670000, 148.900000, 149.320000, 149.260000, 149.520000]
bandgap_almostclose = [0.6999, 1.1214, 1.029, 1.0765, 1.1131, 1.1217, 1.1226, 1.1219, 1.1234, 1.1217, 1.1227, 1.1233, 1.1228, 1.1231, 1.1232, 1.123, 1.1229]

rel_energy = np.zeros(len(energy_clean))
rel_force = np.zeros(len(energy_clean))
rel_pressure = np.zeros(len(energy_clean))
rel_bandgap = np.zeros(len(energy_clean))


for i in range(0, len(energy_clean)):
    rel_energy[i] = energy_o1[i]-energy_clean[i]
    rel_force[i] = force_o1[i]-force_clean[i]
    rel_pressure[i] = pressure_o1[i]-pressure_clean[i]
    rel_bandgap[i] = bandgap_o1[i]-bandgap_clean[i]
    
    
    
 
fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(nrows=2, ncols=2)

ax1.set_title('Relative Total energy')
ax1.plot(encut, rel_energy, '-o') 

ax2.set_title('Bandgap')
ax2.plot(encut, rel_bandgap, '-o')

ax3.set_title('Relative Pressure')
ax3.plot(encut, rel_pressure, '-o')

ax4.set_title('Relative Force') 
ax4.plot(encut, rel_force, '-x') 

plt.tight_layout(pad=0.4, w_pad=0.5, h_pad=1.0)
print encut